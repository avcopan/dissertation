\chapter[%
    Linear-Response Density Cumulant Theory for Excited States:\\
	Better Algorithms, Bigger Systems
]{%
    Linear-Response Density Cumulant Theory for Excited States:\\
	Better Algorithms, Bigger Systems
}
\label{ch:davidson}


\section{Abstract}

Abstract.


\section{Introduction}

\begin{enumerate}
    \item
        Linear response calculations involve large matrix equations, which
        require
        \(
            n_\mathrm{dim}^2
        \)
        storage, rapidly consuming memory requirements
    \item
        Direct alorithms like the multi-root Davidson
        algorithm\cite{Davidson:1975p87,Liu:1978p49} avoid this problem by
        expanding the linear transformations in a reduced basis
        (requiring \(n_\mathrm{red} \times n_\mathrm{dim}\) storage) and
        progressively growing this expansion space to span the
        \(n_\mathrm{root}\) lowest solution vectors to some threshold of
        accuracy.
    \item
        An efficient algorithm satisfies
        \(
            n_\mathrm{root} < n_\mathrm{red} \ll n_\mathrm{dim}
        \)
\end{enumerate}


\section{Theory}

\begin{equation}
    \mathbf{E}(\mathbf{Z})
    =
    \mathbf{M}(\mathbf{Z})
    \boldsymbol{\Omega}
\end{equation}
Need not be square

\begin{equation}
    \mathbf{Z}
    =
    \begin{pmatrix}
        \mathbf{X}_1 \\
        \mathbf{X}_2 \\
        \mathbf{Y}_1 \\
        \mathbf{Y}_2
    \end{pmatrix}
\end{equation}

\begin{equation}
    \mathbf{E}(\mathbf{Z})
    =
    \begin{pmatrix}
        \mathbf{A}_{11}(\mathbf{X}_1) +
        \mathbf{A}_{12}(\mathbf{X}_2) +
        \mathbf{B}_{11}(\mathbf{Y}_1) +
        \mathbf{B}_{12}(\mathbf{Y}_2) \\
        \mathbf{A}_{21}(\mathbf{X}_1) +
        \mathbf{A}_{22}(\mathbf{X}_2) +
        \mathbf{B}_{21}(\mathbf{Y}_1) +
        \mathbf{B}_{22}(\mathbf{Y}_2) \\
        \mathbf{B}^*_{11}(\mathbf{X}_1) +
        \mathbf{B}^*_{12}(\mathbf{X}_2) +
        \mathbf{A}^*_{11}(\mathbf{Y}_1) +
        \mathbf{A}^*_{12}(\mathbf{Y}_2) \\
        \mathbf{B}^*_{21}(\mathbf{X}_1) +
        \mathbf{B}^*_{22}(\mathbf{X}_2) +
        \mathbf{A}^*_{21}(\mathbf{Y}_1) +
        \mathbf{A}^*_{22}(\mathbf{Y}_2) \\
    \end{pmatrix}
\end{equation}


\begin{figure}[h!]
    \centering
    \caption{%
        \label{fig:davidson}
        A schematic illustrating the sequence of reduced representations of
        \(\mathbf{E}\) in the algorithm employed in this study.
        The colored entries must be explicitly computed, whereas the gray
        entries are determined by Hermitian symmetry.
    }
    \includegraphics[width=8.5cm]{figures/davidson.pdf}
\end{figure}

We have implemented the LR-ODC-12 method using a multi-root Davidson algorithm,
which solves the linear-response generalized eigenvalue problem by progressively
growing an expansion space for the \(n_\mathrm{root}\) lowest generalized
eigenvectors of \(\mathbf{E}\) and \(\mathbf{M}\).
The general procedure looks as follows:
\begin{enumerate}
    \item
        \label{item:davidson-initialization}
        Initialize the expansion space with a set of \(n_\mathrm{guess}\geq
        n_\mathrm{root}\) orthonormal vectors.
        \[
            \mathbf{R}^{(0)}
            =
            (
                \mathbf{u}_1^{(0)}
                \cdots
                \mathbf{u}_{n_\mathrm{guess}}^{(0)}
            )
        \]
    \item
        \label{item:davidson-step-one}
        Express the energy-Hessian and metric matrices in the reduced expansion
        space.
        \[
            \mathbf{E}^{(i)}
            =
            \mathbf{R}^{(i)\dagger}
            \mathbf{E}(\mathbf{R}^{(i)})
        \]
        \[
            \mathbf{M}^{(i)}
            =
            \mathbf{R}^{(i)\dagger}
            \mathbf{M}(\mathbf{R}^{(i)})
        \]
    \item
        Solve for the \(n_\mathrm{root}\) highest eigenvectors of the
        inverse eigenvalue equation.
        \[
            \mathbf{M}^{(i)}
            \mathbf{z}_k^{(i)}
            =
            \mathbf{E}^{(i)}
            \mathbf{z}_k^{(i)}/
            \omega_k^{(i)}
        \]
    \item
        Determine the residual for each root.
        \[
            \mathbf{d}_k^{(i)}
            =
            \mathbf{M}(\mathbf{z}_k^{(i)})
            -
            \mathbf{E}(\mathbf{z}_k^{(i)})/
            \omega_k^{(i)}
        \]
        If the residual elements are sufficiently small we consider the
        eigenvectors converged and exit the loop.
    \item
        \label{item:davidson-step-three}
        Form new direction vectors by preconditioning the residuals.
        \[
            \mathbf{g}_k^{(i+1)}
            =
            -
            (
                \tilde{\mathbf{M}}
                -
                \tilde{\mathbf{E}}/
                \omega_k^{(i)}
            )^{-1}
            \mathbf{d}_k
        \]
        The tildes in this equation denote diagonal approximations to these
        matrices.
    \item
        Project out the span of the current expansion space from the new
        direction vectors.
        \[
            \mathbf{J}^{(i+1)}
            =
            (\mathbf{1} - \mathbf{R}^{(i)}\mathbf{R}^{(i)\dagger})
            (\mathbf{g}_1^{(i+1)}\cdots \mathbf{g}_{n_\mathrm{root}}^{(i+1)})
        \]
    \item
        Determine an orthonormal basis for the new direction vectors using a
        compressed singular value decomposition, and add these new vectors to
        the expansion space.
        \[
            \mathbf{J}^{(i+1)}
            \approx
            \mathbf{U}^{(i+1)}
            \boldsymbol\Sigma^{(i+1)}
            \mathbf{V}^{(i+1)\dagger}
        \]
        \[
            \mathbf{R}^{(i+1)}
            \leftarrow
            (\mathbf{R}^{(i)}\ \mathbf{U}^{(i+1)})
        \]
    \item
        Increment \(i\) and return to step~\ref{item:davidson-step-one}.
\end{enumerate}
A key feature of this algorithm is that we never need to explicilty construct
the energy-Hessian and metric matrices in memory, only their images over the
expansion space.

For the diagonal approximations in step~\ref{item:davidson-step-three} we use
the following.
\[
    \tilde{\mathbf{S}}_{11}
    \equiv
    \mathbf{1}_1
\]
\[
    (\tilde{\mathbf{A}}_{11})_{ia,ia}
    \equiv
    -
    f_i^i
    +
    f_a^a
\]
\[
    (\tilde{\mathbf{A}}_{22})_{ijab,ijab}
    \equiv
    -
    \mathcal{F}_i^i
    -
    \mathcal{F}_j^j
    -
    \mathcal{F}_a^a
    -
    \mathcal{F}_b^b
\]
These can also be used to construct the initial expansion space in
step~\ref{item:davidson-initialization}, namely by including unit vectors for
the \(n_\mathrm{guess}\) smallest positive entries in \(\tilde{\mathbf{E}}\).


\section{Computational Details}

For alkenes (\cref{sec:alkenes}), the ANO-L-pVXZ (X = D, T) basis
sets\cite{Widmark:1990p291} were used as in Ref.~\citenum{Daday:2012p4441}.
For alkenes in \cref{sec:alkenes}, the frozen-core MP2/cc-pVQZ geometries were
used as in Refs.~\citenum{Daday:2012p4441} and \citenum{Zimmerman:2017p4712}.



\section{Results}


\subsection{Ethylene, Butadiene, and Hexatriene}
\label{sec:alkenes}

\begin{table*}[h!]
    \caption{%
        \label{tab:alkenes}
        Vertical excitation energies computed using LR-OLCCD, LR-ODC-12, and
        EOM-CCSD for the low-lying electronic states of ethylene (\ce{C2H4}),
        butadiene (\ce{C4H6}), and hexatriene (\ce{C6H8}).
        Computations employed the ANO-L-pVDZ (for \ce{C4H6} and \ce{C6H8}) and
        ANO-L-pVTZ (for \ce{C2H4}) basis sets and the MP2/cc-pVQZ optimized
        geometries.
        For LR-OLCCD and LR-ODC-12, oscillator strengths of the allowed
        transitions are given in parentheses.
        All electrons were correlated in all computations.
    }
    \begin{threeparttable}
        \begin{tabular}{clccccc}
            \hline
            \hline
            && EOM-CCSD & LR-OLCCD & LR-ODC-12 & SHCI\tnote{a} \\
            \hline
            \ce{C2H4}
            & \(1{}^3\mathrm{B_{1u}}\) &
            4.46 & 4.66         & 4.52         & 4.59  \\ 
            & \(1{}^1\mathrm{B_{1u}}\) &
            8.14 & 8.20 (1.8) & 8.14 (1.9) & 8.05 \\
            \hline                           
            \ce{C4H6}                        
            & \(1{}^3\mathrm{B_{u}}\)  &
            3.20 & 3.58         & 3.43         & 3.37 \\
            & \(1{}^1\mathrm{B_{u}}\)  &
            6.53 & 6.76 (4.2) & 6.67 (4.4) & 6.45 \\
            & \(2{}^1\mathrm{A_{g}}\)  &
            7.28 & 7.14         & 6.81         & 6.58 \\
            \hline                           
            \ce{C6H8}                        
            & \(1{}^3\mathrm{B_{u}}\)  &
            2.64 & 3.01         & 2.83         & 2.77 \\
            & \(1{}^1\mathrm{B_{u}}\)  &
            5.60 & 5.89 (6.5)  & 5.74 (8.1)   & 5.59 \\
            & \(2{}^1\mathrm{A_{g}}\)  &
            6.55 &  {\color{red} XXX}   & 5.73              & 5.58 \\
            \hline
            \hline
        \end{tabular}
        \begin{tablenotes}
            \item[a]
                Also shown are the excitation energies from the semistochastic
                heat-bath CI (SHCI) method, extrapolated to full CI
                limit.\cite{Chien:2018p2714}
                The $1s$ orbitals of carbon atoms were not included in the SHCI
                correlation treatment.
                The SHCI computations used the same basis sets and optimized
                geometries as those used for LR-OLCCD, LR-ODC-12, and EOM-CCSD.
        \end{tablenotes}    
    \end{threeparttable}
\end{table*}


We apply the LR-ODC-12 method to challenging excited states of ethylene
(\ce{C2H4}), butadiene (\ce{C4H6}), and hexatriene (\ce{C6H8}).  A reliable
description of these electronic states requires accurate treatment of electron
correlation.\cite{%
    Tavan:1986p6602, Tavan:1987p4337, Nakayama:1998p157,
    Davidson:1996p6161, Watts:1998p6979, Muller:1999p7176, Li:1999p177,
    Starcke:2006p39, Kurashige:2004p425, Ghosh:2008p144117, Sokolov:2017p244102,
    Schreiber:2008p134110, Zgid:2009p194107, Angeli:2010p2436, Daday:2012p4441,
    Watson:2012p4013, Zimmerman:2017p4712%
}
All three molecules feature a dipole-allowed $1{}^1\mathrm{B_{u}}$ (or
$1{}^1\mathrm{B_{1u}}$) state that is well described by a $\pi-\pi^*$
excitation, but requires a very accurate description of dynamic correlation
between the $\sigma$ and $\pi$ electrons.
In butadiene and hexatriene, the $1{}^1\mathrm{B_{u}}$ state is near-degenerate
with a dipole-forbidden $2{}^1\mathrm{A_{g}}$ state that has a substantial
double-excitation character, requiring the description of static correlation in
the $\pi$ and $\pi^*$
orbitals.\cite{Kurashige:2004p425,Ghosh:2008p144117,Sokolov:2017p244102}
For this reason, the relative energies and ordering of the $1{}^1\mathrm{B_{u}}$
and $2{}^1\mathrm{A_{g}}$ states are very sensitive to various levels of theory.
For example, single-reference methods truncated to single and double excitations
are usually more accurate in describing the $1{}^1\mathrm{B_{u}}$ state than the
$2{}^1\mathrm{A_{g}}$ state, while multi-reference methods are more reliable for
the $2{}^1\mathrm{A_{g}}$ state, missing important dynamic correlation for the
$1{}^1\mathrm{B_{u}}$ state.
Very recently, Chien et al.\cite{Chien:2018p2714} reported accurate vertical
excitation energies for the low-lying states of ethylene, butadiene, and
hexatriene computed using semistochastic heat-bath configuration interaction
(SHCI) extrapolated to the full CI limit.
In this section, we will use the SHCI results to benchmark the accuracy of the
LR-ODC-12 method.

\Cref{tab:alkenes} reports the vertical excitation energies of ethylene,
butadiene, and hexatriene computed using the EOM-CCSD, LR-OLCCD, and LR-ODC-12
methods, along with the SHCI results from Ref.\@ \citenum{Chien:2018p2714}.
All methods employed the same optimized geometries and basis sets (see
\cref{tab:alkenes} for details).
We refer to the $\mathrm{B_{1u}}$ states of \ce{C2H4} as $\mathrm{B_{u}}$ for
brevity.
All excitation energies decrease as the number of double bonds increases.
For butadiene and hexatriene, the ($1{}^1\mathrm{B_{u}}$; $2{}^1\mathrm{A_{g}}$)
excitation energies computed using the SHCI method are (6.45; 6.58) and (5.59;
5.58) eV, respectively, indicating that the two states are nearly degenerate for
the longer polyene.
This feature is not reproduced by the EOM-CCSD method, which predicts the
$1{}^1\mathrm{B_{u}}$ state energies in close agreement with SHCI, but
significantly overestimates the energies for the doubly-excited
$2{}^1\mathrm{A_{g}}$ state.
As a result, the EOM-CCSD method overestimates the energy spacing between the
$1{}^1\mathrm{B_{u}}$ and $2{}^1\mathrm{A_{g}}$ states by $\sim$ 0.6 eV and 1.0
eV for butadiene and hexatriene, respectively. 

On the contrary, the LR-ODC-12 method correctly describes the relative energies
and ordering of the $1{}^1\mathrm{B_{u}}$ and $2{}^1\mathrm{A_{g}}$ states,
predicting their energy spacing to be 0.14 and 0.01 eV for butadiene and
hexatriene, respectively, in an excellent agreement with the SHCI results (0.13
and 0.01 eV).
For the singlet excited states, the LR-ODC-12 method consistently overestimates
the SHCI excitation energies by $\sim$ 0.1 -- 0.2 eV.
For the $1{}^3\mathrm{B_{u}}$ state, the LR-ODC-12 errors are smaller in
magnitude ($\sim$ 0.06 eV).
Importantly, these results suggest that the LR-ODC-12 method provides a balanced
description of the excited states with different electronic structure effects,
as illustrated by its consistent performance for the $1{}^3\mathrm{B_{u}}$,
$1{}^1\mathrm{B_{u}}$, and $2{}^1\mathrm{A_{g}}$ states in ethylene, butadiene,
and hexatriene.

Comparing the LR-ODC-12 and the LR-OLCCD results suggests that including the
non-linear terms in the description of electron correlation significantly
improves the agreement with the reference SHCI data.
In particular, for the $1{}^3\mathrm{B_{u}}$ and $1{}^1\mathrm{B_{u}}$ states,
the LR-OLCCD errors are larger than the LR-ODC-12 errors by $\sim$ 0.15 eV.
For the $2{}^1\mathrm{A_{g}}$ doubly-excited state, linearizing the equations in
LR-OLCCD increases the error by 0.33 and {\color{red} XXX} eV for butadiene and
hexatriene, respectively. 
